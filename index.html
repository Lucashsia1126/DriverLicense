<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>è³‡æ–™ç®¡ç†ç³»çµ± v11</title>
  <style>
    /* --- CSS è®Šæ•¸å®šç¾©ï¼šLalamove æ©˜è‰²ç³» --- */
    :root {
      --primary-color: #ff6600;       /* Lalamove æ©˜ */
      --primary-hover: #e55c00;       /* æ·±ä¸€é»çš„æ©˜è‰² */
      --secondary-color: #ffe6d9;     /* æ·ºæ©˜è‰²èƒŒæ™¯ */
      --text-color: #333;
      --border-color: #ddd;
      --bg-color: #f9f9f9;
      --card-shadow: 0 4px 6px rgba(0,0,0,0.1);
    }

    body {
      font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
      background-color: var(--bg-color);
      color: var(--text-color);
      margin: 0;
      padding: 20px;
    }

    /* å®¹å™¨æ¨£å¼ */
    .container {
      max-width: 1000px;
      margin: 0 auto;
      background: white;
      padding: 25px;
      border-radius: 8px;
      box-shadow: var(--card-shadow);
      border-top: 5px solid var(--primary-color); /* é ‚éƒ¨æ©˜è‰²æ¢ */
    }

    h2 {
      text-align: center;
      color: var(--primary-color);
      margin-bottom: 25px;
    }

    /* æœå°‹èˆ‡æ“ä½œå€ */
    .search-box {
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }

    input[type="text"], select {
      padding: 10px;
      border: 1px solid var(--border-color);
      border-radius: 4px;
      flex: 1;
      min-width: 200px;
    }

    input[type="text"]:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 5px var(--secondary-color);
    }

    /* æŒ‰éˆ•å…±ç”¨æ¨£å¼ */
    button {
      background-color: var(--primary-color);
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 4px;
      cursor: pointer;
      font-weight: bold;
      transition: background 0.3s;
    }

    button:hover {
      background-color: var(--primary-hover);
    }

    button.secondary {
      background-color: #6c757d;
    }
    button.secondary:hover {
      background-color: #5a6268;
    }

    /* è¡¨æ ¼æ¨£å¼ */
    .table-responsive {
      overflow-x: auto;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
    }

    th, td {
      padding: 12px;
      text-align: left;
      border-bottom: 1px solid var(--border-color);
    }

    th {
      background-color: var(--primary-color);
      color: white;
      white-space: nowrap;
    }

    tr:hover {
      background-color: var(--secondary-color); /* æ»‘éè®Šæ·ºæ©˜è‰² */
    }

    /* è¼‰å…¥å‹•ç•« */
    #loader {
      display: none;
      text-align: center;
      margin: 20px 0;
      color: var(--primary-color);
      font-weight: bold;
    }

    /* --- æ–°å¢ï¼šåº•éƒ¨æ‰¹æ¬¡æ“ä½œå€å¡Š --- */
    .batch-actions-area {
      margin-top: 40px;
      padding-top: 20px;
      border-top: 2px dashed var(--border-color);
      display: flex;
      justify-content: flex-end; /* æŒ‰éˆ•é å³ */
      gap: 15px;
    }

    .btn-batch {
      background-color: #fff;
      color: var(--primary-color);
      border: 2px solid var(--primary-color);
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .btn-batch:hover {
      background-color: var(--secondary-color);
      color: var(--primary-hover);
    }

    /* éš±è—çš„æª”æ¡ˆä¸Šå‚³ input */
    #fileInput {
      display: none;
    }

  </style>
</head>
<body>

  <div class="container">
    <h2>ğŸšš è³‡æ–™ç®¡ç†ç³»çµ± (Lalamove Style)</h2>

    <div class="search-box">
      <input type="text" id="searchInput" placeholder="è¼¸å…¥é—œéµå­—æœå°‹...">
      <button onclick="performSearch()">æœå°‹</button>
      <button class="secondary" onclick="clearSearch()">é‡ç½®</button>
    </div>

    <div id="loader">è³‡æ–™è¼‰å…¥ä¸­ï¼Œè«‹ç¨å€™...</div>

    <div class="table-responsive">
      <table id="dataTable">
        <thead>
          <tr id="tableHeader">
            <th>ID</th>
            <th>æ—¥æœŸ</th>
            <th>å§“å</th>
            <th>ç‹€æ…‹</th>
            <th>æ“ä½œ</th>
          </tr>
        </thead>
        <tbody id="tableBody">
          <tr>
            <td>001</td>
            <td>2023-12-18</td>
            <td>ç‹å°æ˜</td>
            <td>é…é€ä¸­</td>
            <td><button class="secondary" style="padding:5px 10px; font-size:12px;">ç·¨è¼¯</button></td>
          </tr>
           <tr>
            <td>002</td>
            <td>2023-12-19</td>
            <td>æå¤§è¯</td>
            <td>å·²å®Œæˆ</td>
            <td><button class="secondary" style="padding:5px 10px; font-size:12px;">ç·¨è¼¯</button></td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="batch-actions-area">
      <input type="file" id="fileInput" accept=".csv,.xlsx">
      
      <button class="btn-batch" onclick="triggerBatchUpload()">
        ğŸ“‚ æ‰¹æ¬¡ä¸Šå‚³
      </button>
      
      <button class="btn-batch" onclick="triggerBatchDownload()">
        â¬‡ï¸ æ‰¹æ¬¡ä¸‹è¼‰
      </button>
    </div>

  </div>

  <script>
    // --- ä¿ç•™ v10 ç¾æœ‰åŠŸèƒ½ (æœå°‹èˆ‡æ¸²æŸ“é‚è¼¯) ---

    // æ¨¡æ“¬æœå°‹åŠŸèƒ½ (è«‹æ›¿æ›ç‚ºæ‚¨åŸæœ¬ v10 çš„çœŸå¯¦é‚è¼¯)
    function performSearch() {
      const keyword = document.getElementById('searchInput').value;
      const loader = document.getElementById('loader');
      loader.style.display = 'block';
      
      console.log("æœå°‹é—œéµå­—:", keyword);
      
      // æ¨¡æ“¬å»¶é²
      setTimeout(() => {
        loader.style.display = 'none';
        alert(`æœå°‹åŠŸèƒ½ï¼šæ‚¨æœå°‹äº† "${keyword}" (æ­¤è™•æ‡‰é€£æ¥å¾Œç«¯)`);
      }, 500);
    }

    function clearSearch() {
      document.getElementById('searchInput').value = '';
      alert("é‡ç½®æœå°‹");
    }

    // --- v11 æ–°å¢åŠŸèƒ½ï¼šæ‰¹æ¬¡æ“ä½œ ---

    // 1. æ‰¹æ¬¡ä¸‹è¼‰é‚è¼¯
    function triggerBatchDownload() {
      const confirmed = confirm("ç¢ºå®šè¦ä¸‹è¼‰æ‰€æœ‰è³‡æ–™å—ï¼Ÿ");
      if (confirmed) {
        // TODO: å‘¼å« Google Apps Script å¾Œç«¯å‡½æ•¸
        // google.script.run.withSuccessHandler(downloadFile).getBatchData();
        
        console.log("åŸ·è¡Œæ‰¹æ¬¡ä¸‹è¼‰...");
        alert("âœ… ä¸‹è¼‰è«‹æ±‚å·²ç™¼é€ï¼(åŠŸèƒ½éœ€é€£æ¥å¾Œç«¯ç”Ÿæˆ CSV/Excel)");
      }
    }

    // 2. æ‰¹æ¬¡ä¸Šå‚³é‚è¼¯
    function triggerBatchUpload() {
      // è§¸ç™¼éš±è—çš„ file input é»æ“Šäº‹ä»¶
      document.getElementById('fileInput').click();
    }

    // ç›£è½æª”æ¡ˆé¸æ“‡å¾Œçš„å‹•ä½œ
    document.getElementById('fileInput').addEventListener('change', function(e) {
      const file = e.target.files[0];
      if (!file) return;

      const confirmed = confirm(`æ‚¨é¸æ“‡äº†æª”æ¡ˆï¼š${file.name}\nç¢ºå®šè¦ä¸Šå‚³ä¸¦é€²è¡Œæ‰¹æ¬¡è™•ç†å—ï¼Ÿ`);
      
      if (confirmed) {
        console.log("æº–å‚™ä¸Šå‚³æª”æ¡ˆ:", file);
        
        // --- é€™è£¡å¯«æª”æ¡ˆè®€å–é‚è¼¯ (ä¾‹å¦‚ FileReader) ---
        const reader = new FileReader();
        reader.onload = function(event) {
          const fileContent = event.target.result;
          console.log("æª”æ¡ˆå…§å®¹è®€å–å®Œæˆ");
          
          // TODO: å°‡ fileContent å‚³çµ¦ Google Apps Script
          // google.script.run.withSuccessHandler(onUploadSuccess).processBatchUpload(fileContent);
          
          alert(`âœ… æª”æ¡ˆ ${file.name} ä¸Šå‚³è™•ç†ä¸­...`);
        };
        
        // è®€å–ç‚ºæ–‡å­— (å¦‚æœæ˜¯ CSV) æˆ– ArrayBuffer (å¦‚æœæ˜¯ Excel)
        reader.readAsText(file); 
        
        // ä¸Šå‚³å¾Œæ¸…ç©º inputï¼Œä»¥ä¾¿ä¸‹æ¬¡èƒ½é¸åŒä¸€å€‹æª”æ¡ˆ
        e.target.value = ''; 
      } else {
        // å–æ¶ˆæ™‚ä¹Ÿæ¸…ç©º
        e.target.value = '';
      }
    });

  </script>
</body>
</html>
